<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Discontinuous Galerkin Library: dg::Invert&lt; container &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Discontinuous Galerkin Library
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Discontinuous Galerkin numerical methods and container free numerical algorithms</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structdg_1_1_invert.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="structdg_1_1_invert-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dg::Invert&lt; container &gt; Struct Template Reference<div class="ingroups"><a class="el" href="group__algorithms.html">Numerical schemes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Smart conjugate gradient solver.  
 <a href="structdg_1_1_invert.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cg_8h_source.html">cg.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a36911150e0779cce30ef7e7d002ef0ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_invert.html#a36911150e0779cce30ef7e7d002ef0ac">Invert</a> (const container &amp;copyable, unsigned max_iter, double eps, double nrmb_correction=1)</td></tr>
<tr class="memdesc:a36911150e0779cce30ef7e7d002ef0ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a36911150e0779cce30ef7e7d002ef0ac">More...</a><br/></td></tr>
<tr class="separator:a36911150e0779cce30ef7e7d002ef0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba7447f25ad0b970efe0df955c1da484"><td class="memTemplParams" colspan="2">template&lt;class SymmetricOp &gt; </td></tr>
<tr class="memitem:aba7447f25ad0b970efe0df955c1da484"><td class="memTemplItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structdg_1_1_invert.html#aba7447f25ad0b970efe0df955c1da484">operator()</a> (SymmetricOp &amp;op, container &amp;phi, const container &amp;rho)</td></tr>
<tr class="memdesc:aba7447f25ad0b970efe0df955c1da484"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve linear problem.  <a href="#aba7447f25ad0b970efe0df955c1da484">More...</a><br/></td></tr>
<tr class="separator:aba7447f25ad0b970efe0df955c1da484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04af60e082a2c5a2058fae930338001b"><td class="memTemplParams" colspan="2">template&lt;class SymmetricOp , class Weights , class Preconditioner &gt; </td></tr>
<tr class="memitem:a04af60e082a2c5a2058fae930338001b"><td class="memTemplItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structdg_1_1_invert.html#a04af60e082a2c5a2058fae930338001b">operator()</a> (SymmetricOp &amp;op, container &amp;phi, const container &amp;rho, Weights &amp;w, Preconditioner &amp;p)</td></tr>
<tr class="memdesc:a04af60e082a2c5a2058fae930338001b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve linear problem.  <a href="#a04af60e082a2c5a2058fae930338001b">More...</a><br/></td></tr>
<tr class="separator:a04af60e082a2c5a2058fae930338001b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c32f7fdd5c123eab428283df6cf83c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_invert.html#ab1c32f7fdd5c123eab428283df6cf83c">set_max</a> (unsigned new_max)</td></tr>
<tr class="memdesc:ab1c32f7fdd5c123eab428283df6cf83c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the maximum number of iterations.  <a href="#ab1c32f7fdd5c123eab428283df6cf83c">More...</a><br/></td></tr>
<tr class="separator:ab1c32f7fdd5c123eab428283df6cf83c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bf8b8325e4b96dc859103b09a3112a7"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_invert.html#a9bf8b8325e4b96dc859103b09a3112a7">get_max</a> () const </td></tr>
<tr class="memdesc:a9bf8b8325e4b96dc859103b09a3112a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current maximum number of iterations.  <a href="#a9bf8b8325e4b96dc859103b09a3112a7">More...</a><br/></td></tr>
<tr class="separator:a9bf8b8325e4b96dc859103b09a3112a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class container&gt;<br/>
struct dg::Invert&lt; container &gt;</h3>

<p>Smart conjugate gradient solver. </p>
<p>Solve a symmetric linear inversion problem using a conjugate gradient method and the last two solutions.</p>
<p>Solves the Equation </p>
<p class="formulaDsp">
\[ \hat O \phi = W \cdot \rho \]
</p>
<p> for any operator \(\hat O\) that was made symmetric by appropriate weights \(W\) (s. comment below). It uses solutions from the last two calls to extrapolate a solution for the current call. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">container</td><td>The Vector class to be used </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>A note on weights and preconditioning. A normalized DG-discretized derivative or operator is normally not symmetric. The diagonal coefficient matrix that is used to make the operator symmetric is called weights W, i.e. \( \hat O = W\cdot O\) is symmetric. Independent from this, a preconditioner should be used to solve the symmetric matrix equation. Most often the inverse of \(W\) is a good preconditioner. </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a36911150e0779cce30ef7e7d002ef0ac"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class container &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdg_1_1_invert.html">dg::Invert</a>&lt; container &gt;::<a class="el" href="structdg_1_1_invert.html">Invert</a> </td>
          <td>(</td>
          <td class="paramtype">const container &amp;&#160;</td>
          <td class="paramname"><em>copyable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nrmb_correction</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">copyable</td><td>Needed to construct the two previous solutions </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum iteration in conjugate gradient </td></tr>
    <tr><td class="paramname">eps</td><td>relative error in conjugate gradient </td></tr>
    <tr><td class="paramname">nrmb_correction</td><td>Correction factor for norm of b (cf. <a class="el" href="classdg_1_1_c_g.html" title="Functor class for the preconditioned conjugate gradient method to solve . ">CG</a>) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a9bf8b8325e4b96dc859103b09a3112a7"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class container &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="structdg_1_1_invert.html">dg::Invert</a>&lt; container &gt;::get_max </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the current maximum number of iterations. </p>
<dl class="section return"><dt>Returns</dt><dd>the current maximum </dd></dl>

</div>
</div>
<a class="anchor" id="aba7447f25ad0b970efe0df955c1da484"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class container &gt; </div>
<div class="memtemplate">
template&lt;class SymmetricOp &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="structdg_1_1_invert.html">dg::Invert</a>&lt; container &gt;::operator() </td>
          <td>(</td>
          <td class="paramtype">SymmetricOp &amp;&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">container &amp;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const container &amp;&#160;</td>
          <td class="paramname"><em>rho</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve linear problem. </p>
<p>Solves the Equation </p>
<p class="formulaDsp">
\[ \hat O \phi = W\rho \]
</p>
<p> using a preconditioned conjugate gradient method. The initial guess comes from an extrapolation of the last solutions </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SymmetricOp</td><td>Symmetric operator with the SelfMadeMatrixTag The functions weights() and precond() need to be callable and return weights and the preconditioner for the conjugate gradient method. The Operator is assumed to be symmetric! </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>selfmade symmetric Matrix operator class </td></tr>
    <tr><td class="paramname">phi</td><td>solution (write only) </td></tr>
    <tr><td class="paramname">rho</td><td>right-hand-side</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of iterations used </dd></dl>

</div>
</div>
<a class="anchor" id="a04af60e082a2c5a2058fae930338001b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class container &gt; </div>
<div class="memtemplate">
template&lt;class SymmetricOp , class Weights , class Preconditioner &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="structdg_1_1_invert.html">dg::Invert</a>&lt; container &gt;::operator() </td>
          <td>(</td>
          <td class="paramtype">SymmetricOp &amp;&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">container &amp;&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const container &amp;&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Weights &amp;&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Preconditioner &amp;&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve linear problem. </p>
<p>Solves the Equation </p>
<p class="formulaDsp">
\[ \hat O \phi = W\rho \]
</p>
<p> using a preconditioned conjugate gradient method. The initial guess comes from an extrapolation of the last solutions. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">SymmetricOp</td><td>Symmetric matrix or operator (with the selfmade tag) </td></tr>
    <tr><td class="paramname">Weights</td><td>class of the weights container </td></tr>
    <tr><td class="paramname">Preconditioner</td><td>class of the Preconditioner </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>selfmade symmetric Matrix operator class </td></tr>
    <tr><td class="paramname">phi</td><td>solution (write only) </td></tr>
    <tr><td class="paramname">rho</td><td>right-hand-side </td></tr>
    <tr><td class="paramname">w</td><td>The weights that made the operator symmetric </td></tr>
    <tr><td class="paramname">p</td><td>The preconditioner</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of iterations used </dd></dl>

</div>
</div>
<a class="anchor" id="ab1c32f7fdd5c123eab428283df6cf83c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class container &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="structdg_1_1_invert.html">dg::Invert</a>&lt; container &gt;::set_max </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>new_max</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the maximum number of iterations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_max</td><td>New maximum number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>/home/matthias/Projekte/feltor/inc/dg/<a class="el" href="cg_8h_source.html">cg.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedg.html">dg</a></li><li class="navelem"><a class="el" href="structdg_1_1_invert.html">Invert</a></li>
    <li class="footer">Generated on Mon Mar 16 2015 13:46:55 for Discontinuous Galerkin Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
